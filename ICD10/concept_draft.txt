drop table icd10_list;
create table icd10_list as 
select distinct 
--(regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) as position, 
class_code||MODIFIERCLASS_CODE as concept_code, a.label||' '||b.label as concept_name
-- ,a.*, b.*
from classes a
join modifier_classes b on class_code = regexp_replace (regexp_replace (MODIFIERCLASS_MODIFIER, '^(I\d\d)|(S\d\d)'), '_\d')
where (regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) = 4
and a.RUBRIC_KIND ='preferred' and b.RUBRIC_KIND ='preferred'
union
select distinct --(regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) as position, 
class_code||MODIFIERCLASS_CODE as concept_code, a.label||' '||b.label
-- ,a.*, b.*
from classes a
join modifier_classes b on regexp_replace ( class_code, '\.\d$' ) = regexp_replace (regexp_replace (MODIFIERCLASS_MODIFIER, '^(I\d\d)|(S\d\d)'), '_\d')
where (regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) = 5
and a.RUBRIC_KIND ='preferred' and b.RUBRIC_KIND ='preferred'
and length (class_code) = 5
union
select distinct class_code, label from classes
where RUBRIC_KIND ='preferred' 
and class_kind = 'category'

;
select distinct --(regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) as position, 
class_code||MODIFIERCLASS_CODE as concept_code, a.label||' '||b.label
-- ,a.*, b.*
from classes a
join modifier_classes b on regexp_replace ( class_code, '\.\d$' ) = regexp_replace (regexp_replace (MODIFIERCLASS_MODIFIER, '^(I\d\d)|(S\d\d)'), '_\d')
where (regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) = 5
and a.RUBRIC_KIND ='preferred' and b.RUBRIC_KIND ='preferred'
and length (class_code) = 5
and class_code like 'F11%'
;
select * from modifier_classes where MODIFIERCLASS_MODIFIER like '%F1%'
;
select * from MODIFIERs
;
select * from classes where class_code like 'K26%';
where CLASS_CODE like 'F10-%'
;
select * from classes where RUBRIC_KIND =
'modifierlink'
;
select * from classes 
where CLASS_CODE like 'F70-%'
;
select distinct CLASS_KIND from classes where class_kind = 'category'
;
select * from classes where class_kind = 'chapter'
;
select distinct class_code from classes where CLASS_KIND = 'block'
;
select distinct c.class_code,c.SUPERCLASS_CODE,c.label, a.* from classes c left join (
select distinct 
--(regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) as position, 
class_code||MODIFIERCLASS_CODE as concept_code, a.label||' '||b.label as concept_name
-- ,a.*, b.*
from classes a
join modifier_classes b on class_code = regexp_replace (regexp_replace (MODIFIERCLASS_MODIFIER, '^(I\d\d)|(S\d\d)'), '_\d')
where (regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) = 4
and a.RUBRIC_KIND ='preferred' and b.RUBRIC_KIND ='preferred'
union
select distinct --(regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) as position, 
class_code||MODIFIERCLASS_CODE as concept_code, a.label||' '||b.label
-- ,a.*, b.*
from classes a
join modifier_classes b on regexp_replace ( class_code, '\.\d$' ) = regexp_replace (regexp_replace (MODIFIERCLASS_MODIFIER, '^(I\d\d)|(S\d\d)'), '_\d')
where (regexp_substr (MODIFIERCLASS_MODIFIER, '\d$') ) = 5
and a.RUBRIC_KIND ='preferred' and b.RUBRIC_KIND ='preferred'
and length (class_code) = 5
) a on regexp_substr (c.class_code, '...') = regexp_substr (a.concept_code, '...')
 where RUBRIC_KIND =
'modifierlink'
;