create table aut_ingredient_mapped_1 as (select distinct ingredient,concept_id,concept_name,'1' as precedence from ingredients a join devv5.concept b on ingredient=upper(concept_name) 
where ingredient is not null and concept_class_id='Ingredient' and standard_concept='S' and vocabulary_id in ('RxNorm','RxNorm Extension'));

select distinct ingredient,concept_id,concept_name from ingredients a
join devv5.concept b on utl_match.edit_distance (ingredient,upper(concept_name))=1
where ingredient not in (select ingredient from aut_ingredient_mapped_1)
and ingredient is not null and concept_class_id='Ingredient' and standard_concept='S' and vocabulary_id in ('RxNorm','RxNorm Extension');

create table aut_ingredient_mapped_2
(
ingredient varchar (255),
concept_id number,
concept_name  varchar (255));
WbImport -file=C:/Users/aostropolets/Desktop/Australia/aut_ingr_map_2.txt
         -type=text
         -table=AUT_INGREDIENT_MAPPED_2
         -encoding="ISO-8859-15"
         -header=true
         -decode=false
         -dateFormat=dd/m/yyyy
         -timestampFormat=dd/m/yyyy
         -delimiter='\t'
         -quotechar='"'
         -decimal=.
         -fileColumns=INGREDIENT,CONCEPT_ID,CONCEPT_NAME
         -quoteCharEscaping=none
         -ignoreIdentityColumns=false
         -deleteTarget=false
         -continueOnError=false;
/*=
select distinct ingredient,concept_id,concept_name from ingredients a
join devv5.concept b on utl_match.edit_distance (ingredient,upper(concept_name))=1
where ingredient not in (select ingredient from aut_ingredient_mapped_1)
and ingredient is not null and concept_class_id='Ingredient' and standard_concept='S' and vocabulary_id in ('RxNorm','RxNorm Extension');*/ 